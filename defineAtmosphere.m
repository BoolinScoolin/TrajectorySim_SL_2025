function atmosphericData = defineAtmosphere(latitude, longitude, hour)
% function atmosphere = defineAtmosphere()
% Defimnes atmospheric properties
%
% Inputs
%   latitude -  geocentric latitude [deg]
%       float
%   longitude - Earth-centered longitude [deg]
%       float
%   hour - desired time of data (24 hour clock, EST)
%       int
%
% Outputs
%   atmosphericData - atmospheric properties at standardized pressures
%       struct


%% API Pull
latitude = chop(latitude, 6);
longitude = chop(longitude,6);

% Pulls atmospheric data for today
atmosphericAPIurl = sprintf('https://api.open-meteo.com/v1/forecast?latitude=%g&longitude=%g&hourly=temperature_1000hPa,temperature_975hPa,temperature_950hPa,temperature_925hPa,temperature_900hPa,temperature_875hPa,temperature_850hPa,temperature_825hPa,temperature_800hPa,temperature_775hPa,temperature_750hPa,temperature_725hPa,temperature_700hPa,temperature_675hPa,temperature_650hPa,geopotential_height_1000hPa,geopotential_height_975hPa,geopotential_height_950hPa,geopotential_height_925hPa,geopotential_height_900hPa,geopotential_height_875hPa,geopotential_height_850hPa,geopotential_height_825hPa,geopotential_height_800hPa,geopotential_height_775hPa,geopotential_height_750hPa,geopotential_height_725hPa,geopotential_height_700hPa,geopotential_height_675hPa,geopotential_height_650hPa&wind_speed_unit=ms&forecast_days=1&models=gfs_seamless', latitude, longitude);
data = webread(atmosphericAPIurl);

% Pulls elevation at coordinates
elevationAPIurl = sprintf('https://api.open-elevation.com/api/v1/lookup?locations=%g,%g', latitude, longitude);
sealeveldata = webread(elevationAPIurl);
atmosphericData.elevation = sealeveldata.results.elevation;

atmosphericData.pressures = 100*(1000:-25:650)';

atmosphericData.heights = [data.hourly.geopotential_height_1000hPa(hour)...
    data.hourly.geopotential_height_975hPa(hour)...
    data.hourly.geopotential_height_950hPa(hour)...
    data.hourly.geopotential_height_925hPa(hour)...
    data.hourly.geopotential_height_900hPa(hour)...
    data.hourly.geopotential_height_875hPa(hour)...
    data.hourly.geopotential_height_850hPa(hour)...
    data.hourly.geopotential_height_825hPa(hour)...
    data.hourly.geopotential_height_800hPa(hour)...
    data.hourly.geopotential_height_775hPa(hour)...
    data.hourly.geopotential_height_750hPa(hour)...
    data.hourly.geopotential_height_725hPa(hour)...
    data.hourly.geopotential_height_700hPa(hour)...
    data.hourly.geopotential_height_675hPa(hour)...
    data.hourly.geopotential_height_650hPa(hour)]';

atmosphericData.temperatures = [data.hourly.temperature_1000hPa(hour)...
    data.hourly.temperature_975hPa(hour)...
    data.hourly.temperature_950hPa(hour)...
    data.hourly.temperature_925hPa(hour)...
    data.hourly.temperature_900hPa(hour)...
    data.hourly.temperature_875hPa(hour)...
    data.hourly.temperature_850hPa(hour)...
    data.hourly.temperature_825hPa(hour)...
    data.hourly.temperature_800hPa(hour)...
    data.hourly.temperature_775hPa(hour)...
    data.hourly.temperature_750hPa(hour)...
    data.hourly.temperature_725hPa(hour)...
    data.hourly.temperature_700hPa(hour)...
    data.hourly.temperature_675hPa(hour)...
    data.hourly.temperature_650hPa(hour)]';


